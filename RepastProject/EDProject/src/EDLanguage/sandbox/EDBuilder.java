package EDLanguage.sandbox;

/*Generated by MPS */

import repast.simphony.dataLoader.ContextBuilder;
import repast.simphony.context.Context;
import repast.simphony.context.space.continuous.ContinuousSpaceFactory;
import repast.simphony.context.space.continuous.ContinuousSpaceFactoryFinder;
import repast.simphony.space.continuous.ContinuousSpace;
import repast.simphony.space.continuous.RandomCartesianAdder;
import repast.simphony.space.continuous.StrictBorders;
import repast.simphony.context.space.grid.GridFactory;
import repast.simphony.context.space.grid.GridFactoryFinder;
import repast.simphony.space.grid.Grid;
import repast.simphony.space.grid.GridBuilderParameters;
import repast.simphony.space.grid.SimpleGridAdder;
import simcore.basicStructures.Board;
import simcore.basicStructures.PatientAdder;
import repast.simphony.valueLayer.GridValueLayer;
import simcore.basicStructures.Location;
import repast.simphony.space.continuous.NdPoint;

public class EDBuilder implements ContextBuilder<Object> {

  public Context build(Context<Object> context) {

    context.setId("EDProject");


    ContinuousSpaceFactory spaceFactory = ContinuousSpaceFactoryFinder.createContinuousSpaceFactory(null);
    ContinuousSpace<Object> space = spaceFactory.createContinuousSpace("space", context, new RandomCartesianAdder<Object>(), new StrictBorders(), 400, 200);

    GridFactory gridFactory = GridFactoryFinder.createGridFactory(null);
    Grid<Object> grid = gridFactory.createGrid("grid", context, new GridBuilderParameters<Object>(new repast.simphony.space.grid.StrictBorders(), new SimpleGridAdder<Object>(), true, 400, 200));

    context.add(new Board());
    context.add(new PatientAdder(space, grid).WithTimeSpan(20));


    // add Agents 
    for (int i = 0; i < 5; i++) {
      context.add(new Doctor(space, grid));
    }
    for (int i = 0; i < 7; i++) {
      context.add(new Nurse(space, grid));
    }
    for (int i = 0; i < 3; i++) {
      context.add(new ENP(space, grid));
    }


    GridValueLayer vl = new GridValueLayer("cellbox", true, new repast.simphony.space.grid.StrictBorders(), 400, 200);
    context.addValueLayer(vl);

    // add Locations here 
    Location Pediatrics_a = new Location("Pediatrics", context, space, grid, 5, 145, 50, 50, 1, 40, "Right");
    Location MainReceptions_b = new Location("MainReceptions", context, space, grid, 55, 125, 20, 20, 1, 40, "Top");
    Location Triage_c = new Location("Triage", context, space, grid, 105, 132, 20, 20, 1, 15, "Left");
    Location exit_d = new Location("exit", context, space, grid, 95, 192, 10, 2, 1, 500, "Top");
    Location TaskRoom_e = new Location("TaskRoom", context, space, grid, 130, 105, 20, 20, 1, 15, "Bottom");
    Location MajorsC_f = new Location("MajorsC", context, space, grid, 120, 50, 50, 50, 1, 50, "Top");
    Location Entrance_g = new Location("Entrance", context, space, grid, 95, 192, 10, 2, 1, 500, "Top");
    Location XRayRoom1_h = new Location("XRayRoom1", context, space, grid, 155, 105, 20, 20, 1, 10, "Bottom");
    Location WaitingRoom_i = new Location("WaitingRoom", context, space, grid, 105, 155, 30, 30, 1, 200, "Left");






    for (Object obj : context) {
      NdPoint pt = space.getLocation(obj);
      grid.moveTo(obj, (int) pt.getX(), (int) pt.getY());
    }


    return context;
  }
}
