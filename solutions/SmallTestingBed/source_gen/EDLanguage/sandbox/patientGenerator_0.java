package EDLanguage.sandbox;

/*Generated by MPS */

import simcore.basicStructures.AgentGenerator;
import repast.simphony.space.continuous.ContinuousSpace;
import repast.simphony.space.grid.Grid;
import repast.simphony.context.Context;
import repast.simphony.engine.schedule.ScheduledMethod;
import simcore.basicStructures.Board;
import simcore.basicStructures.ToolBox;
import simcore.Signals.Signal;
import simcore.Signals.ActorTypeSignal;
import repast.simphony.random.RandomHelper;
import repast.simphony.engine.environment.RunEnvironment;
import java.util.HashMap;

public class patientGenerator_0 extends AgentGenerator {
  public patientGenerator_0(ContinuousSpace<Object> space, Grid<Object> grid, Context<Object> context) {
    super(space, grid, context);
    spawnRoomType = MainEntrance.getInstance();
    initialiseArrivalMap();
  }

  @ScheduledMethod(start = 1, interval = 1)
  public void step() {
    tick();
  }

  public Object onGenerate() {
    patient a = new patient(space, grid, context);
    Board b = new ToolBox(this).ReadBoard();

    Signal sendSignalTemp = new ActorTypeSignal();

    sendSignalTemp.setName("PatientArrivesTrigger_k");
    sendSignalTemp.AddData("patient", a);
    sendSignalTemp.AddActor("TriageNurse");


    // For each agent attribute
    // For each attribute value option
    // Assign the value based on probability function
    double rndDouble = RandomHelper.nextDouble();

    this.generateAttribute_a(a);
    this.generateAttribute_b(a);
    this.generateAttribute_c(a);
    this.generateAttribute_d(a);
    this.generateAttribute_e(a);
    this.generateAttribute_f(a);

    b.PushMission(sendSignalTemp);

    return a;
  }

  public void generateAttribute_a(patient agent) {
    double rndDouble = RandomHelper.nextDouble();

    double runningTotal = 0;

    runningTotal = (RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendancecohortEmergencyAttendance"));
    if (rndDouble < (runningTotal / 100)) {
      agent.cohort = "EmergencyAttendance";
      return;
    }

  }
  public void generateAttribute_b(patient agent) {
    double rndDouble = RandomHelper.nextDouble();

    double runningTotal = 0;

    runningTotal = (RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusSusceptible"));
    if (rndDouble < (runningTotal / 100)) {
      agent.COVIDInfectionStatus = "Susceptible";
      return;
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusSymptomatic") + runningTotal) / 100)) {
      agent.COVIDInfectionStatus = "Symptomatic";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusSymptomatic");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusSymptomatic");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusAsymptomatic") + runningTotal) / 100)) {
      agent.COVIDInfectionStatus = "Asymptomatic";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusAsymptomatic");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusAsymptomatic");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusExposed") + runningTotal) / 100)) {
      agent.COVIDInfectionStatus = "Exposed";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusExposed");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceCOVIDInfectionStatusExposed");
    }

  }
  public void generateAttribute_c(patient agent) {
    double rndDouble = RandomHelper.nextDouble();

    double runningTotal = 0;

    runningTotal = (RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusSusceptible"));
    if (rndDouble < (runningTotal / 100)) {
      agent.FluAInfectionStatus = "Susceptible";
      return;
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusSymptomatic") + runningTotal) / 100)) {
      agent.FluAInfectionStatus = "Symptomatic";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusSymptomatic");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusSymptomatic");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusAsymptomatic") + runningTotal) / 100)) {
      agent.FluAInfectionStatus = "Asymptomatic";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusAsymptomatic");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusAsymptomatic");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusExposed") + runningTotal) / 100)) {
      agent.FluAInfectionStatus = "Exposed";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusExposed");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluAInfectionStatusExposed");
    }

  }
  public void generateAttribute_d(patient agent) {
    double rndDouble = RandomHelper.nextDouble();

    double runningTotal = 0;

    runningTotal = (RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusSusceptible"));
    if (rndDouble < (runningTotal / 100)) {
      agent.FluBInfectionStatus = "Susceptible";
      return;
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusSymptomatic") + runningTotal) / 100)) {
      agent.FluBInfectionStatus = "Symptomatic";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusSymptomatic");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusSymptomatic");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusAsymptomatic") + runningTotal) / 100)) {
      agent.FluBInfectionStatus = "Asymptomatic";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusAsymptomatic");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusAsymptomatic");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusExposed") + runningTotal) / 100)) {
      agent.FluBInfectionStatus = "Exposed";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusExposed");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceFluBInfectionStatusExposed");
    }

  }
  public void generateAttribute_e(patient agent) {
    double rndDouble = RandomHelper.nextDouble();

    double runningTotal = 0;

    runningTotal = (RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritylow"));
    if (rndDouble < (runningTotal / 100)) {
      agent.Severity = "low";
      return;
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritymoderate") + runningTotal) / 100)) {
      agent.Severity = "moderate";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritymoderate");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritymoderate");
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritysevere") + runningTotal) / 100)) {
      agent.Severity = "severe";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritysevere");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceSeveritysevere");
    }

  }
  public void generateAttribute_f(patient agent) {
    double rndDouble = RandomHelper.nextDouble();

    double runningTotal = 0;

    runningTotal = (RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceImmunocompromisedNo"));
    if (rndDouble < (runningTotal / 100)) {
      agent.Immunocompromised = "No";
      return;
    }
    if (rndDouble < ((RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceImmunocompromisedYes") + runningTotal) / 100)) {
      agent.Immunocompromised = "Yes";
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceImmunocompromisedYes");
      return;
    } else {
      runningTotal += RunEnvironment.getInstance().getParameters().getDouble("EmergencyAttendanceImmunocompromisedYes");
    }

  }

  public void initialiseArrivalMap() {
    ArrivalPerHour = new HashMap<Integer, Integer>();
    ArrivalPerHour.put(1, 5);
    ArrivalPerHour.put(2, 8);
    ArrivalPerHour.put(3, 8);
    ArrivalPerHour.put(4, 4);
    ArrivalPerHour.put(5, 4);
    ArrivalPerHour.put(6, 9);
    ArrivalPerHour.put(7, 3);
    ArrivalPerHour.put(8, 3);
    ArrivalPerHour.put(9, 6);
    ArrivalPerHour.put(10, 13);
    ArrivalPerHour.put(11, 13);
    ArrivalPerHour.put(12, 16);
    ArrivalPerHour.put(13, 16);
    ArrivalPerHour.put(14, 18);
    ArrivalPerHour.put(15, 19);
    ArrivalPerHour.put(16, 20);
    ArrivalPerHour.put(17, 18);
    ArrivalPerHour.put(18, 16);
    ArrivalPerHour.put(19, 11);
    ArrivalPerHour.put(20, 9);
    ArrivalPerHour.put(21, 10);
    ArrivalPerHour.put(22, 9);
    ArrivalPerHour.put(23, 13);
    ArrivalPerHour.put(24, 4);



  }
}
